<template>
  <div id="map"></div>
  <form @submit.prevent="addFeature">
    </form>
</template>

<script>
import L from 'leaflet';

export default {
  mounted() {
    this.map = L.map('map').setView([-33.49, -70.65], 13);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(this.map);

    // Crear capas para puntos, líneas y polígonos
    this.pointsLayer = L.layerGroup().addTo(this.map);
    this.linesLayer = L.layerGroup().addTo(this.map);
    this.polygonsLayer = L.layerGroup().addTo(this.map);
  },
  methods: {
    addFeature() {
      // Obtener datos del formulario
      const featureType = /* ... */; // Determinar si es punto, línea o polígono
      const geometry = /* ... */; // Crear objeto GeoJSON
      const properties = /* ... */; // Asignar propiedades

      // Crear una capa y agregarla al mapa
      const layer = L.geoJSON(geometry, { properties }).addTo(this[`${featureType}Layer`]);

      // Enviar los datos al servidor para guardar en la base de datos
      this.saveFeature(layer);
    },
    saveFeature(feature) {
      // Hacer una petición HTTP al servidor para guardar los datos
      // Ejemplo con axios:
      axios.post('/api/features', feature.toGeoJSON())
        .then(response => {
          console.log('Feature saved successfully');
        })
        .catch(error => {
          console.error('Error saving feature:', error);
        });
    }
  }
}
</script>
