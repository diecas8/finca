<!-- Esto es como tu cuaderno m√°gico ‚ú® -->
<!DOCTYPE html>
<html>
<head>
    <title>Finca Caf√© M√°gico üå±</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        .seccion { background: #e0f7fa; padding: 20px; margin: 10px; border-radius: 10px; }
        input, button { margin: 5px; padding: 8px; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { border: 1px solid #4CAF50; padding: 8px; }
    </style>
<head>
    <title>Finca Caf√© M√°gico üå±</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        .seccion { background: #e0f7fa; padding: 20px; margin: 10px; border-radius: 10px; }
        
        .columnas-magicas {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        label {
            display: block;
            margin: 10px 0 5px;
            color: #2e7d32;
            font-weight: bold;
        }
        
        input, button { margin: 5px; padding: 8px; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
    </style>
</head>

<div class="seccion">
    <h2>üìã Informaci√≥n de la Finca</h2>
    <form id="fincaForm" onsubmit="guardarFinca(event)">
        <div class="columnas-magicas">
            <div>
                <label>Nombre de la finca:</label>
                <input type="text" id="nombreFinca" required>
                
                <label>√Årea total (hect√°reas):</label>
                <input type="number" step="0.01" id="areaTotal" required>
                
                <label>Propietario:</label>
                <input type="text" id="propietario" required>
            </div>
            
            <div>
                <label>Vereda:</label>
                <input type="text" id="vereda" required>
                
                <label>Municipio:</label>
                <input type="text" id="municipio" required>
                
                <label>√Årea en caf√© (auto):</label>
                <input type="number" step="0.01" id="areaCafe" readonly>
            </div>
        </div>
        <button type="submit">üíæ Guardar</button>
    </form>
<div class="seccion">
    <h2>üõí Compras de Insumos</h2>
    <form id="compraForm" onsubmit="comprarInsumo(event)">
        <div class="columnas-magicas">
            <div>
                <label>Fecha:</label>
                <input type="date" id="fechaCompra" required>
                
                <label>Insumo:</label>
                <input type="text" id="insumo" required>
                
                <label>Unidad de medida:</label>
                <input type="text" id="unidadMedida" required>
            </div>
            
            <div>
                <label>Cantidad:</label>
                <input type="number" step="0.01" id="cantidadCompra" required>
                
                <label>Valor unitario:</label>
                <input type="number" step="0.01" id="valorUnitario" required>
                
                <label>Valor total:</label>
                <input type="number" id="valorTotal" readonly>
            </div>
        </div>
        <button type="submit">üõí Agregar</button>
    </form>
</div>
<div class="seccion">
    <h2>üå± Lotes de Caf√©</h2>
    <form id="loteForm" onsubmit="guardarLote(event)">
        <div class="columnas-magicas">
            <div>
                <label>N√∫mero de lote:</label>
                <input type="text" id="numLote" required>
                
                <label>√Årea (hect√°reas):</label>
                <input type="number" step="0.01" id="areaLote" oninput="calcularPlantas()" required>
                
                <label>Distancia entre calles (metros):</label>
                <input type="number" step="0.01" id="distanciaCalles" oninput="calcularPlantas()" required>
            </div>
            
            <div>
                <label>Distancia entre plantas (metros):</label>
                <input type="number" step="0.01" id="distanciaPlantas" oninput="calcularPlantas()" required>
                
                <label>Densidad (plantas/ha):</label>
                <input type="text" id="densidad" readonly style="background: #e0f7fa;">
                
                <label>Total de plantas:</label>
                <input type="text" id="numPlantas" readonly style="background: #e0f7fa;">
            </div>
        </div>
        <button type="submit">üíæ Guardar Lote</button>
    </form>
</div>
    <div class="seccion">
    <h2>üì¶ Usar Insumos en Lotes</h2>
    <select id="loteUso">
        <option>Elige un lote</option>
    </select>
    <select id="insumoUso">
        <option>Elige insumo</option>
    </select>
    <input type="number" step="0.01" id="cantidadUso" placeholder="Cantidad a usar">
    <button onclick="usarInsumo()">‚ûñ Usar</button>
</div>
    <div class="seccion">
    <h2>üìä Reporte de Lotes de Caf√©</h2>
    <button onclick="generarReporteLotes()">üñ®Ô∏è Generar Reporte</button>
    <table id="reporteLotes">
        <thead>
            <tr>
                <th>N√∫mero</th>
                <th>√Årea (ha)</th>
                <th>Densidad (plantas/ha)</th>
                <th>Total Plantas</th>
            </tr>
        </thead>
        <tbody>
            <!-- Aqu√≠ se llenar√°n los datos -->
        </tbody>
    </table>
</div>
    <div class="seccion">
    <h2>üë∑ Actividades en Lotes</h2>
    <form id="actividadForm" onsubmit="guardarActividad(event)">
        <div class="columnas-magicas">
            <div>
                <label>Lote:</label>
                <select id="loteActividad" required>
                    <option value="">Elige un lote</option>
                </select>
                
                <label>Fecha:</label>
                <input type="date" id="fechaActividad" required>
                
                <label>Actividad:</label>
                <input type="text" id="nombreActividad" required>
            </div>
            
            <div>
                <label>Jornales:</label>
                <input type="number" id="jornales" required>
                
                <label>Valor por jornal:</label>
                <input type="number" step="0.01" id="valorJornal" required>
                
                <label>Valor total:</label>
                <input type="number" id="totalActividad" readonly>
            </div>
        </div>
        <button type="submit">üíæ Guardar</button>
    </form>
</div>
    <div class="seccion">
    <h2>üìä Reporte de Insumos</h2>
    <button onclick="generarReporteInsumos()">üñ®Ô∏è Generar Reporte</button>
    <table id="reporteInsumos">
        <thead>
            <tr>
                <th>Insumo</th>
                <th>Unidad</th>
                <th>En Stock</th>
                <th>Disponible</th>
            </tr>
        </thead>
        <tbody>
            <!-- Aqu√≠ se llenar√°n los datos -->
        </tbody>
    </table>
</div>
    <div class="seccion">
    <h2>üìä Reporte de Actividades</h2>
    <button onclick="generarReporteActividades()">üñ®Ô∏è Generar Reporte</button>
    <table id="reporteActividades">
        <thead>
            <tr>
                <th>Lote</th>
                <th>Actividad</th>
                <th>Jornales</th>
                <th>Costo Total</th>
            </tr>
        </thead>
        <tbody>
            <!-- Aqu√≠ se llenar√°n los datos -->
        </tbody>
    </table>
</div>

    <script>
        let bodega = {};
let lotes = [];
let usandoInsumoEditIndex = -1;
        let datosFinca = {
            nombre: "",
            areaTotal: 0,
            propietario: "",
            vereda: "",
            municipio: ""
        };

       function guardarFinca(event) {
    event.preventDefault();
    
    datosFinca = {
        nombre: document.getElementById('nombreFinca').value,
        areaTotal: parseFloat(document.getElementById('areaTotal').value),
        propietario: document.getElementById('propietario').value,
        vereda: document.getElementById('vereda').value,
        municipio: document.getElementById('municipio').value
    };
    
    localStorage.setItem('datosFinca', JSON.stringify(datosFinca));
    alert("‚úÖ ¬°Informaci√≥n guardada!");
}

        function actualizarAreaCafe() {
            const total = lotes.reduce((sum, lote) => sum + parseFloat(lote.area), 0);
            document.getElementById('areaCafe').value = total.toFixed(2);
        }
function calcularPlantas() {
    const area = parseFloat(document.getElementById('areaLote').value) || 0;
    const calles = parseFloat(document.getElementById('distanciaCalles').value) || 0;
    const plantas = parseFloat(document.getElementById('distanciaPlantas').value) || 0;

    if (calles > 0 && plantas > 0) {
        const densidad = 10000 / (calles * plantas); // 10,000 m¬≤ = 1 hect√°rea
        document.getElementById('densidad').value = densidad.toFixed(2); // Mostrar con 2 decimales

        const totalPlantas = area * densidad;
        document.getElementById('numPlantas').value = Math.round(totalPlantas); // Redondeamos
    } else {
        document.getElementById('densidad').value = '';
        document.getElementById('numPlantas').value = '';
    }
}
   function guardarLote(event) {
    event.preventDefault(); // Evita que el formulario se recargue
    
    // üßô‚Äç‚ôÇÔ∏è Capturamos los datos del lote
    const nuevoLote = {
        numero: document.getElementById('numLote').value,
        area: parseFloat(document.getElementById('areaLote').value),
        distanciaCalles: parseFloat(document.getElementById('distanciaCalles').value),
        distanciaPlantas: parseFloat(document.getElementById('distanciaPlantas').value),
        densidad: document.getElementById('densidad').value,
        numPlantas: document.getElementById('numPlantas').value
    };

    // üóÑÔ∏è Guardamos en el "cofre del tesoro" (localStorage)
    let lotesGuardados = JSON.parse(localStorage.getItem('lotes')) || []; // Si no hay, crea uno vac√≠o
    lotesGuardados.push(nuevoLote); // Agregamos el nuevo lote
    localStorage.setItem('lotes', JSON.stringify(lotesGuardados)); // Guardamos en el cofre

    // üéâ Mostramos mensaje y limpiamos el formulario
    alert("‚úÖ ¬°Lote guardado!");
    document.getElementById('loteForm').reset(); // Limpia los campos
    actualizarAreaCafe(); // Actualiza el √°rea total
}
           function comprarInsumo(event) {
    event.preventDefault();
    
    const nuevaCompra = {
        fecha: document.getElementById('fechaCompra').value,
        insumo: document.getElementById('insumo').value,
        unidad: document.getElementById('unidadMedida').value,
        cantidad: parseFloat(document.getElementById('cantidadCompra').value),
        valorUnitario: parseFloat(document.getElementById('valorUnitario').value),
        total: parseFloat(document.getElementById('valorTotal').value)
    };

    let comprasGuardadas = JSON.parse(localStorage.getItem('compras')) || [];
    comprasGuardadas.push(nuevaCompra);
    localStorage.setItem('compras', JSON.stringify(comprasGuardadas));

    alert("‚úÖ ¬°Compra guardada!");
    document.getElementById('compraForm').reset();
}
            // ‚ñº‚ñº‚ñº Actualizar Bodega ‚ñº‚ñº‚ñº
    function actualizarBodega() {
        const tabla = document.getElementById('tablaBodega');
        tabla.innerHTML = `
            <tr>
                <th>Insumo</th>
                <th>Unidad</th>
                <th>En Stock</th>
                <th>√öltima Compra</th>
                <th>Total Usado</th>
                <th>Disponible</th>
            </tr>`;

        for (let insumo in bodega) {
            tabla.innerHTML += `
                <tr>
                    <td>${insumo}</td>
                    <td>${bodega[insumo].unidad}</td>
                    <td>${bodega[insumo].existencia.toFixed(2)}</td>
                    <td>${new Date().toLocaleDateString()}</td>
                    <td>0.00</td>
                    <td>${bodega[insumo].existencia.toFixed(2)}</td>
                </tr>`;
        }
    }
        function cargarDatos() {
    // üóÑÔ∏è Cargamos los lotes guardados
    const lotesGuardados = JSON.parse(localStorage.getItem('lotes')) || [];
    const selectLote = document.getElementById('loteUso');
    selectLote.innerHTML = '<option value="">Elige un lote</option>'; // Limpiamos el selector
    
    lotesGuardados.forEach(lote => {
        const option = document.createElement('option');
        option.value = lote.numero;
        option.textContent = `Lote ${lote.numero}`;
        selectLote.appendChild(option);
    });

    // üóÑÔ∏è Cargamos los insumos guardados
    const bodegaGuardada = JSON.parse(localStorage.getItem('bodega')) || {};
    const selectInsumo = document.getElementById('insumoUso');
    selectInsumo.innerHTML = '<option value="">Elige insumo</option>'; // Limpiamos el selector
    
    for (let insumo in bodegaGuardada) {
        const option = document.createElement('option');
        option.value = insumo;
        option.textContent = `${insumo} (${bodegaGuardada[insumo].existencia} ${bodegaGuardada[insumo].unidad})`;
        selectInsumo.appendChild(option);
    }
}
          <div class="seccion">
    <h2>üì¶ Usar Insumos en Lotes</h2>
    <form id="usoInsumoForm" onsubmit="usarInsumo(event)">
        <div class="columnas-magicas">
            <div>
                <label>Lote:</label>
                <select id="loteUso" required>
                    <option value="">Elige un lote</option>
                </select>
                
                <label>Insumo:</label>
                <select id="insumoUso" required>
                    <option value="">Elige insumo</option>
                </select>
            </div>
            
            <div>
                <label>Cantidad a usar:</label>
                <input type="number" step="0.01" id="cantidadUso" required>
            </div>
        </div>
        <button type="submit">‚ûñ Usar</button>
    </form>
</div>
       function guardarActividad(event) {
    event.preventDefault();
    
    const nuevaActividad = {
        lote: document.getElementById('loteActividad').value,
        fecha: document.getElementById('fechaActividad').value,
        nombre: document.getElementById('nombreActividad').value,
        jornales: document.getElementById('jornales').value,
        valor: document.getElementById('valorJornal').value,
        total: document.getElementById('totalActividad').value
    };

    let actividadesGuardadas = JSON.parse(localStorage.getItem('actividades')) || [];
    actividadesGuardadas.push(nuevaActividad);
    localStorage.setItem('actividades', JSON.stringify(actividadesGuardadas));

    alert("‚úÖ ¬°Actividad guardada!");
    document.getElementById('actividadForm').reset();
}
        // ‚ñº‚ñº‚ñº Cargar al Iniciar ‚ñº‚ñº‚ñº
   window.onload = function () {
    // üóÑÔ∏è Cargamos los lotes del "cofre del tesoro"
    let lotesGuardados = JSON.parse(localStorage.getItem('lotes')) || [];
    lotes = lotesGuardados; // Los ponemos en la memoria

    // üé® Actualizamos la interfaz
    actualizarBodega();
    actualizarAreaCafe();
};
        function generarReporteLotes() {
    const lotes = JSON.parse(localStorage.getItem('lotes')) || [];
    const tbody = document.getElementById('reporteLotes').querySelector('tbody');
    tbody.innerHTML = ''; // Limpiamos la tabla

    lotes.forEach(lote => {
        const fila = `
            <tr>
                <td>${lote.numero}</td>
                <td>${lote.area}</td>
                <td>${lote.densidad}</td>
                <td>${lote.numPlantas}</td>
            </tr>`;
        tbody.innerHTML += fila;
    });

    alert("‚úÖ Reporte generado");
}
        function generarReporteInsumos() {
    const bodega = JSON.parse(localStorage.getItem('bodega')) || {};
    const tbody = document.getElementById('reporteInsumos').querySelector('tbody');
    tbody.innerHTML = ''; // Limpiamos la tabla

    for (let insumo in bodega) {
        const fila = `
            <tr>
                <td>${insumo}</td>
                <td>${bodega[insumo].unidad}</td>
                <td>${bodega[insumo].existencia.toFixed(2)}</td>
                <td>${bodega[insumo].existencia.toFixed(2)}</td>
            </tr>`;
        tbody.innerHTML += fila;
    }

    alert("‚úÖ Reporte generado");
}
        function generarReporteActividades() {
    const actividades = JSON.parse(localStorage.getItem('actividades')) || [];
    const tbody = document.getElementById('reporteActividades').querySelector('tbody');
    tbody.innerHTML = ''; // Limpiamos la tabla

    actividades.forEach(act => {
        const fila = `
            <tr>
                <td>${act.lote}</td>
                <td>${act.nombre}</td>
                <td>${act.jornales}</td>
                <td>${act.total}</td>
            </tr>`;
        tbody.innerHTML += fila;
    });

    alert("‚úÖ Reporte generado");
}
        function usarInsumo(event) {
    event.preventDefault();
    
    const lote = document.getElementById('loteUso').value;
    const insumo = document.getElementById('insumoUso').value;
    const cantidad = parseFloat(document.getElementById('cantidadUso').value);

    if (bodega[insumo] && bodega[insumo].existencia >= cantidad) {
        bodega[insumo].existencia -= cantidad;
        localStorage.setItem('bodega', JSON.stringify(bodega)); // Actualizamos la bodega
        alert(`‚úÖ ¬°Usados ${cantidad} kg de ${insumo} en el lote ${lote}!`);
    } else {
        alert("üö® ¬°No hay suficiente en bodega!");
    }
}
        window.onload = function () {
    cargarDatos(); // Cargamos los datos al iniciar
    actualizarBodega(); // Actualizamos la tabla de bodega
    actualizarAreaCafe(); // Actualizamos el √°rea total en caf√©
};
</script>

</body>
</html>
