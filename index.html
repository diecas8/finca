<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestor Finca Cafetera</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f0f0;
        }
        .section {
            background: white;
            border: 1px solid #ddd;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .form-group {
            margin-bottom: 15px;
        }
        input, select, button {
            padding: 8px;
            margin: 5px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
            width: 100%;
            box-sizing: border-box;
        }
        button {
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
            padding: 10px;
        }
        button:hover {
            background-color: #45a049;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #4CAF50;
            color: white;
        }
        @media (min-width: 768px) {
            .columns {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- Encabezado -->
    <div class="section">
        <h2>Información General</h2>
        <form id="fincaForm">
            <div class="columns">
                <div class="form-group">
                    <label>Nombre de la finca:</label>
                    <input type="text" id="nombreFinca" required>
                </div>
                <div class="form-group">
                    <label>Área total (hectáreas):</label>
                    <input type="number" id="areaTotal" required>
                </div>
                <div class="form-group">
                    <label>Propietario:</label>
                    <input type="text" id="propietario" required>
                </div>
                <div class="form-group">
                    <label>Vereda:</label>
                    <input type="text" id="vereda" required>
                </div>
                <div class="form-group">
                    <label>Municipio:</label>
                    <input type="text" id="municipio" required>
                </div>
            </div>
            <button type="submit">Guardar Información</button>
        </form>
    </div>

    <!-- Compra de Insumos -->
    <div class="section">
        <h2>Compra de Insumos</h2>
        <form id="compraForm">
            <div class="columns">
                <div class="form-group">
                    <label>Fecha:</label>
                    <input type="date" id="fechaCompra" required>
                </div>
                <div class="form-group">
                    <label>Insumo:</label>
                    <input type="text" id="insumo" required>
                </div>
                <div class="form-group">
                    <label>Unidad de medida:</label>
                    <input type="text" id="unidadMedida" required>
                </div>
                <div class="form-group">
                    <label>Cantidad:</label>
                    <input type="number" id="cantidadCompra" required>
                </div>
                <div class="form-group">
                    <label>Valor unitario:</label>
                    <input type="number" id="valorUnitario" required>
                </div>
                <div class="form-group">
                    <label>Valor total:</label>
                    <input type="number" id="valorTotal" readonly>
                </div>
            </div>
            <button type="submit">Registrar Compra</button>
        </form>
    </div>

    <!-- Bodega de Insumos -->
    <div class="section">
        <h2>Bodega de Insumos</h2>
        <table id="tablaBodega">
            <thead>
                <tr>
                    <th>Insumo</th>
                    <th>Unidad</th>
                    <th>Existencia</th>
                </tr>
            </thead>
            <tbody id="cuerpoBodega"></tbody>
        </table>
    </div>

    <!-- Lotes -->
    <div class="section">
        <h2>Gestión de Lotes</h2>
        <form id="loteForm">
            <div class="columns">
                <div class="form-group">
                    <label>Número de lote:</label>
                    <input type="text" id="numLote" required>
                </div>
                <div class="form-group">
                    <label>Variedad de café:</label>
                    <input type="text" id="variedad" required>
                </div>
                <div class="form-group">
                    <label>Área (hectáreas):</label>
                    <input type="number" id="areaLote" required>
                </div>
                <div class="form-group">
                    <label>Tipo de labor:</label>
                    <input type="text" id="tipoLabor" required>
                </div>
                <div class="form-group">
                    <label>Fecha de labor:</label>
                    <input type="date" id="fechaLabor" required>
                </div>
                <div class="form-group">
                    <label>Distancia entre calles (m):</label>
                    <input type="number" id="distanciaCalles" required>
                </div>
                <div class="form-group">
                    <label>Distancia entre plantas (m):</label>
                    <input type="number" id="distanciaPlantas" required>
                </div>
                <div class="form-group">
                    <label>Densidad:</label>
                    <input type="number" id="densidad" readonly>
                </div>
                <div class="form-group">
                    <label>Número de plantas:</label>
                    <input type="number" id="numPlantas" readonly>
                </div>
            </div>
            <button type="submit">Guardar Lote</button>
        </form>
        
        <h3>Lotes Registrados</h3>
        <table id="tablaLotes">
            <thead>
                <tr>
                    <th>Número</th>
                    <th>Variedad</th>
                    <th>Área</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody id="cuerpoTablaLotes"></tbody>
        </table>
    </div>

    <!-- Resto de secciones (Aplicación de Insumos, Actividades, Recolección) -->
    <!-- ... (Similar estructura a las secciones anteriores) ... -->

<script>
// Almacenamiento de datos
let datos = {
    finca: {},
    compras: [],
    bodega: {},
    lotes: [],
    aplicaciones: [],
    actividades: [],
    cosechas: []
};

// Cargar datos al iniciar
if(localStorage.getItem('datosFinca')) {
    datos = JSON.parse(localStorage.getItem('datosFinca'));
}

// Guardar datos
function guardarDatos() {
    localStorage.setItem('datosFinca', JSON.stringify(datos));
}

// Calculos automáticos
document.getElementById('cantidadCompra').addEventListener('input', calcularTotal);
document.getElementById('valorUnitario').addEventListener('input', calcularTotal);

function calcularTotal() {
    const cantidad = parseFloat(document.getElementById('cantidadCompra').value) || 0;
    const valor = parseFloat(document.getElementById('valorUnitario').value) || 0;
    document.getElementById('valorTotal').value = (cantidad * valor).toFixed(2);
}

// Manejo de formulario de compras
document.getElementById('compraForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const nuevaCompra = {
        fecha: document.getElementById('fechaCompra').value,
        insumo: document.getElementById('insumo').value,
        unidad: document.getElementById('unidadMedida').value,
        cantidad: parseFloat(document.getElementById('cantidadCompra').value),
        valorUnitario: parseFloat(document.getElementById('valorUnitario').value),
        total: parseFloat(document.getElementById('valorTotal').value)
    };
    
    datos.compras.push(nuevaCompra);
    
    // Actualizar bodega
    if(datos.bodega[nuevaCompra.insumo]) {
        datos.bodega[nuevaCompra.insumo].existencia += nuevaCompra.cantidad;
    } else {
        datos.bodega[nuevaCompra.insumo] = {
            unidad: nuevaCompra.unidad,
            existencia: nuevaCompra.cantidad
        };
    }
    
    guardarDatos();
    this.reset();
});

// Actualizar tabla de bodega
function actualizarBodega() {
    const tbody = document.getElementById('cuerpoBodega');
    tbody.innerHTML = '';
    
    for(const insumo in datos.bodega) {
        const fila = `<tr>
            <td>${insumo}</td>
            <td>${datos.bodega[insumo].unidad}</td>
            <td>${datos.bodega[insumo].existencia}</td>
        </tr>`;
        tbody.innerHTML += fila;
    }
}

// Manejo de formulario de lotes
document.getElementById('loteForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const nuevoLote = {
        numero: document.getElementById('numLote').value,
        variedad: document.getElementById('variedad').value,
        area: parseFloat(document.getElementById('areaLote').value),
        labor: document.getElementById('tipoLabor').value,
        fechaLabor: document.getElementById('fechaLabor').value,
        distanciaCalles: parseFloat(document.getElementById('distanciaCalles').value),
        distanciaPlantas: parseFloat(document.getElementById('distanciaPlantas').value),
        densidad: parseFloat(document.getElementById('densidad').value),
        numPlantas: parseFloat(document.getElementById('numPlantas').value)
    };
    
    datos.lotes.push(nuevoLote);
    guardarDatos();
    actualizarLotes();
    this.reset();
});

// Actualizar tabla de lotes
function actualizarLotes() {
    const tbody = document.getElementById('cuerpoTablaLotes');
    tbody.innerHTML = '';
    
    datos.lotes.forEach((lote, index) => {
        const fila = `<tr>
            <td>${lote.numero}</td>
            <td>${lote.variedad}</td>
            <td>${lote.area}</td>
            <td>
                <button onclick="editarLote(${index})">Editar</button>
                <button onclick="eliminarLote(${index})">Eliminar</button>
            </td>
        </tr>`;
        tbody.innerHTML += fila;
    });
}

function editarLote(index) {
    const lote = datos.lotes[index];
    // Rellenar formulario con datos
    document.getElementById('numLote').value = lote.numero;
    document.getElementById('variedad').value = lote.variedad;
    // ... completar otros campos
}

function eliminarLote(index) {
    datos.lotes.splice(index, 1);
    guardarDatos();
    actualizarLotes();
}

// Cargar datos al iniciar
window.onload = function() {
    actualizarBodega();
    actualizarLotes();
};
</script>

</body>
</html>
