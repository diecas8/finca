<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Sistema Integral de GestiÃ³n Cafetera</title>
    <style>
        /* Estilos CSS aquÃ­ */
    </style>
</head>
<body>

<!-- Formulario de Insumos -->
<div class="form-container">
    <h2>ðŸ›’ Registro de Insumos</h2>
    <form id="insumosForm">
        <div class="form-group">
            <label>Fecha de Compra:</label>
            <input type="date" id="fechaCompra" required>
        </div>
        <div class="form-group">
            <label>Insumo:</label>
            <div style="display: flex; gap: 5px;">
                <select id="tipoInsumo" required>
                    <option value="">Seleccionar</option>
                    <option>Urea</option>
                    <option>Dap</option>
                    <option>KCL</option>
                    <option>Cal dolomita</option>
                    <option>Cal agricola</option>
                    <option>Cal apagada</option>
                    <option>Insecticida</option>
                    <option>Fungicida</option>
                    <option>Herbicida</option>
                    <option>Alambre</option>
                    <option>Grapas</option>
                    <option>Puntilla</option>
                    <option>Gasolina</option>
                    <option>Aceite</option>
                    <option>Coco Recolector</option>
                    <option>Cuchilla GuadaÃ±a</option>
                    <option>Lima</option>
                    <option>Machete</option>
                    <option>PalÃ­n</option>
                    <option>Costales</option>
                </select>
                <input type="text" id="nuevoInsumo" placeholder="Nuevo insumo" style="flex: 1;">
                <button type="button" onclick="agregarInsumo()">âž•</button>
            </div>
        </div>
        <div class="form-group">
            <label>Unidad de Medida:</label>
            <select id="unidadMedida" required>
                <option>Bulto</option>
                <option>Kilo</option>
                <option>Litro</option>
                <option>GalÃ³n</option>
                <option>Unidad</option>
                <option>Cuarto</option>
            </select>
        </div>
        <div class="form-group">
            <label>Cantidad:</label>
            <input type="number" step="0.01" id="cantidadInsumo" required>
        </div>
        <div class="form-group">
            <label>Valor Unitario:</label>
            <input type="number" id="valorUnitario" required>
        </div>
        <div class="total-box">
            ðŸ’° Valor Total: $<span id="totalInsumo">0</span>
        </div>
        <button type="button" onclick="guardarInsumo()">Guardar Insumo</button>
    </form>
</div>

<!-- Tabla de Insumos -->
<div class="form-container">
    <h3>ðŸ“‹ Insumos Registrados</h3>
    <table>
        <thead>
            <tr>
                <th>Fecha</th>
                <th>Insumo</th>
                <th>Unidad</th>
                <th>Cantidad</th>
                <th>V. Unitario</th>
                <th>Total</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody id="registrosInsumos"></tbody>
    </table>
</div>

<script>
    let insumos = [];
    let editandoInsumo = false;
    let indiceEdicionInsumo = null;

    function agregarInsumo() {
        const nuevo = document.getElementById('nuevoInsumo').value.trim();
        if (nuevo) {
            const select = document.getElementById('tipoInsumo');
            const option = document.createElement('option');
            option.value = nuevo;
            option.textContent = nuevo;
            select.appendChild(option);
            document.getElementById('nuevoInsumo').value = '';
        }
    }

    function calcularTotalInsumo() {
        const cantidad = parseFloat(document.getElementById('cantidadInsumo').value) || 0;
        const valor = parseFloat(document.getElementById('valorUnitario').value) || 0;
        document.getElementById('totalInsumo').textContent = (cantidad * valor).toLocaleString();
    }

    function guardarInsumo() {
        const insumo = {
            fecha: document.getElementById('fechaCompra').value,
            tipo: document.getElementById('tipoInsumo').value,
            unidad: document.getElementById('unidadMedida').value,
            cantidad: parseFloat(document.getElementById('cantidadInsumo').value),
            valor: parseFloat(document.getElementById('valorUnitario').value),
            total: parseFloat(document.getElementById('totalInsumo').textContent.replace(/,/g, ''))
        };

        if (editandoInsumo) {
            insumos[indiceEdicionInsumo] = insumo;
            editandoInsumo = false;
            indiceEdicionInsumo = null;
            document.getElementById('cancelInsumo').style.display = 'none';
        } else {
            insumos.push(insumo);
        }

        actualizarTablaInsumos();
        document.getElementById('insumosForm').reset();
        document.getElementById('totalInsumo').textContent = '0';
    }

    function actualizarTablaInsumos() {
        const tbody = document.getElementById('registrosInsumos');
        tbody.innerHTML = insumos.map((insumo, index) => `
            <tr>
                <td>${insumo.fecha}</td>
                <td>${insumo.tipo}</td>
                <td>${insumo.unidad}</td>
                <td>${insumo.cantidad}</td>
                <td>$${insumo.valor.toLocaleString()}</td>
                <td>$${insumo.total.toLocaleString()}</td>
                <td>
                    <button onclick="editarInsumo(${index})">Editar</button>
                    <button onclick="eliminarInsumo(${index})" style="background-color: #f44336;">Eliminar</button>
                </td>
            </tr>
        `).join('');
    }

    function editarInsumo(index) {
        const insumo = insumos[index];
        document.getElementById('fechaCompra').value = insumo.fecha;
        document.getElementById('tipoInsumo').value = insumo.tipo;
        document.getElementById('unidadMedida').value = insumo.unidad;
        document.getElementById('cantidadInsumo').value = insumo.cantidad;
        document.getElementById('valorUnitario').value = insumo.valor;
        
        editandoInsumo = true;
        indiceEdicionInsumo = index;
        document.getElementById('cancelInsumo').style.display = 'inline-block';
        calcularTotalInsumo();
    }

    function eliminarInsumo(index) {
        insumos.splice(index, 1);
        actualizarTablaInsumos();
    }

    function cancelarEdicionInsumo() {
        editandoInsumo = false;
        indiceEdicionInsumo = null;
        document.getElementById('insumosForm').reset();
        document.getElementById('cancelInsumo').style.display = 'none';
        document.getElementById('totalInsumo').textContent = '0';
    }

    // Event listeners para cÃ¡lculos en tiempo real
    document.getElementById('cantidadInsumo').addEventListener('input', calcularTotalInsumo);
    document.getElementById('valorUnitario').addEventListener('input', calcularTotalInsumo);
</script>
</body>
</html>
